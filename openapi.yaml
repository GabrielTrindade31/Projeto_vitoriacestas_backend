openapi: 3.0.3
info:
  title: API Estoque Vitória Cestas
  version: 1.2.0
  description: Endpoints para gestão de itens, fornecedores, autenticação e demais cadastros previstos no banco de dados.
servers:
  - url: http://{host}
    variables:
      host:
        default: localhost:3000
  - url: https://projeto-vitoriacestas-backend.vercel.app
paths:
  /api/auth/login:
    post:
      summary: Login com perfis
      tags: [Autenticação]
      description: Autentica usuário (Admin, Gestor ou Operador) e retorna tokens de acesso e refresh.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
            examples:
              admin:
                summary: Administrador padrão (memória)
                value:
                  email: admin@vitoriacestas.com
                  password: admin123
              gestor:
                summary: Gestor padrão (memória)
                value:
                  email: gestor@vitoriacestas.com
                  password: gestor123
              operador:
                summary: Operador padrão (memória)
                value:
                  email: operador@vitoriacestas.com
                  password: operador123
      responses:
        '200':
          description: Tokens gerados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      role:
                        type: string
                      name:
                        type: string
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  expiresIn:
                    type: string
        '400':
          description: Requisição inválida
        '401':
          description: Credenciais inválidas
  /auth/login:
    post:
      summary: Login com perfis (alias)
      tags: [Autenticação]
      description: Alias sem prefixo de /api para autenticar usuários e retornar tokens de acesso e refresh.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        '200':
          description: Tokens gerados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      role:
                        type: string
                      name:
                        type: string
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  expiresIn:
                    type: string
        '400':
          description: Requisição inválida
        '401':
          description: Credenciais inválidas
  /api/auth/refresh:
    post:
      summary: Renovação de tokens
      tags: [Autenticação]
      description: Gera um novo par de tokens a partir de um refresh token válido.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [refreshToken]
              properties:
                refreshToken:
                  type: string
      responses:
        '200':
          description: Tokens renovados
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  expiresIn:
                    type: string
        '400':
          description: Requisição inválida
        '401':
          description: Refresh token inválido
  /auth/refresh:
    post:
      summary: Renovação de tokens (alias)
      tags: [Autenticação]
      description: Alias sem prefixo /api para renovar tokens a partir de um refresh token válido.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [refreshToken]
              properties:
                refreshToken:
                  type: string
      responses:
        '200':
          description: Tokens renovados
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  expiresIn:
                    type: string
        '400':
          description: Requisição inválida
        '401':
          description: Refresh token inválido
  /api/items:
    get:
      summary: Lista itens cadastrados
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Itens retornados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Item'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra novo item
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para perfis Admin e Gestor.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemInput'
      responses:
        '201':
          description: Item criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '409':
          description: Código duplicado
  /api/items/images:
    get:
      summary: Lista URLs de imagens vinculadas aos itens
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador. Retorna o vínculo entre ID do produto e a URL pública salva no Blob.
      responses:
        '200':
          description: Relações imagem-produto retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  images:
                    type: array
                    items:
                      $ref: '#/components/schemas/ItemImage'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/items/search:
    get:
      summary: Busca itens pelo termo informado
      tags: [Itens]
      security:
        - bearerAuth: []
      description: "Disponível para Admin, Gestor e Operador. Filtra por código, nome, categoria ou descrição usando comparação parcial."
      parameters:
        - in: query
          name: q
          required: true
          schema:
            type: string
          description: Termo de busca (case-insensitive)
      responses:
        '200':
          description: Itens encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Item'
        '400':
          description: Parâmetro de busca ausente ou inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/items/{id}:
    get:
      summary: Busca item pelo ID
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID do item
      responses:
        '200':
          description: Item retornado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  item:
                    $ref: '#/components/schemas/Item'
        '400':
          description: ID inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Item não encontrado
    put:
      summary: Atualiza um item existente
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para perfis Admin e Gestor.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID do item a ser atualizado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemInput'
      responses:
        '200':
          description: Item atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemResponse'
        '400':
          description: Falha de validação ou ID inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Item não encontrado
        '409':
          description: Código duplicado
  /api/products:
    get:
      summary: Lista produtos cadastrados (alias de /api/items)
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Produtos retornados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Item'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra novo produto (alias de /api/items)
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para perfis Admin e Gestor.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemInput'
      responses:
        '201':
          description: Produto criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '409':
          description: Código duplicado
  /api/products/images:
    get:
      summary: Lista URLs de imagens vinculadas aos produtos (alias de /api/items/images)
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Relações imagem-produto retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  images:
                    type: array
                    items:
                      $ref: '#/components/schemas/ItemImage'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/products/search:
    get:
      summary: Busca produtos pelo termo informado (alias de /api/items/search)
      tags: [Itens]
      security:
        - bearerAuth: []
      description: "Disponível para Admin, Gestor e Operador. Filtra por código, nome, categoria ou descrição usando comparação parcial."
      parameters:
        - in: query
          name: q
          required: true
          schema:
            type: string
          description: Termo de busca (case-insensitive)
      responses:
        '200':
          description: Produtos encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Item'
        '400':
          description: Parâmetro de busca ausente ou inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/products/{id}:
    get:
      summary: Busca produto pelo ID (alias de /api/items/{id})
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID do produto
      responses:
        '200':
          description: Produto retornado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  item:
                    $ref: '#/components/schemas/Item'
        '400':
          description: ID inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Produto não encontrado
    put:
      summary: Atualiza um produto existente (alias de /api/items/{id})
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Disponível para perfis Admin e Gestor.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID do produto a ser atualizado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemInput'
      responses:
        '200':
          description: Produto atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemResponse'
        '400':
          description: Falha de validação ou ID inválido
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Produto não encontrado
        '409':
          description: Código duplicado
  /api/upload:
    post:
      summary: Upload de imagem opcional
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Recebe um arquivo de imagem (campo `file`), salva em `public/uploads/`, publica no Vercel Blob quando a variável `BLOB_READ_WRITE_TOKEN` estiver configurada e grava uma cópia base64 no Redis com a chave `image:public:uploads/<arquivo>` (TTL configurável via `IMAGE_CACHE_TTL_SECONDS`, padrão 1800s). Caso o nome não possa ser extraído do corpo multipart, o cabeçalho opcional `x-filename` será utilizado. Alias disponível também em `/upload`.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: Upload salvo e armazenado em cache
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Upload salvo com sucesso
                  filename:
                    type: string
                    nullable: true
                  mimetype:
                    type: string
                  size:
                    type: integer
                  url:
                    type: string
                    example: https://exemplo.blob.vercel-storage.com/uploads/123-foto.png
                  blobUrl:
                    type: string
                    nullable: true
                  publicUrl:
                    type: string
                    example: /uploads/123-foto.png
                  cacheKey:
                    type: string
                    example: image:public:uploads/123-foto.png
                  cacheTtlSeconds:
                    type: integer
                    example: 1800
                    description: TTL configurado para a entrada de cache no Redis
                  blobConfigured:
                    type: boolean
                    example: true
                    description: Indica se o token BLOB_READ_WRITE_TOKEN estava definido no momento do upload
                  blobTimedOut:
                    type: boolean
                    example: false
                    description: Indica se a publicação no Blob excedeu o tempo limite (padrão 10s) e foi ignorada
                  cacheTimedOut:
                    type: boolean
                    example: false
                    description: Indica se a gravação no Redis excedeu o tempo limite (padrão 5s) e foi ignorada
        '400':
          description: Nenhum arquivo foi enviado
        '500':
          description: Erro interno ao processar o upload (ex.: falha de escrita em disco ou exceção não tratada)
  /upload:
    post:
      summary: Upload de imagem opcional (alias)
      tags: [Itens]
      security:
        - bearerAuth: []
      description: Alias direto de `/api/upload` para receber um arquivo (campo `file`) e retornar metadados do upload com a URL pública (Blob ou `/uploads/...`), chave de cache no Redis e TTL aplicado.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: Upload recebido
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Upload recebido
                  filename:
                    type: string
                  mimetype:
                    type: string
                  size:
                    type: integer
        '400':
          description: Nenhum arquivo foi enviado
  /api/suppliers:
    get:
      summary: Lista fornecedores cadastrados
      tags: [Fornecedores]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Fornecedores retornados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  suppliers:
                    type: array
                    items:
                      $ref: '#/components/schemas/Fornecedor'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra fornecedor
      tags: [Fornecedores]
      security:
        - bearerAuth: []
      description: Disponível apenas para perfil Admin.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FornecedorInput'
      responses:
        '201':
          description: Fornecedor criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FornecedorResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '409':
          description: CNPJ duplicado
  /suppliers:
    get:
      summary: Lista fornecedores cadastrados (alias)
      tags: [Fornecedores]
      security:
        - bearerAuth: []
      description: Alias sem prefixo /api para compatibilidade com o frontend.
      responses:
        '200':
          description: Fornecedores retornados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  suppliers:
                    type: array
                    items:
                      $ref: '#/components/schemas/Fornecedor'
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra fornecedor (alias)
      tags: [Fornecedores]
      security:
        - bearerAuth: []
      description: Alias de `/api/suppliers` para criação de fornecedores.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FornecedorInput'
      responses:
        '201':
          description: Fornecedor criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FornecedorResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '409':
          description: CNPJ duplicado
  /api/addresses:
    get:
      summary: Lista endereços cadastrados
      tags: [Endereços]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Endereços retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  addresses:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnderecoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      description: Cria um novo endereço para ser associado a clientes ou fornecedores.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnderecoInput'
      responses:
        '201':
          description: Endereço criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnderecoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/addresses/search:
    get:
      summary: Busca endereços
      tags: [Endereços]
      security:
        - bearerAuth: []
      description: Pesquisa por rua, CEP ou número. Disponível para Admin, Gestor e Operador.
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo de busca (rua, CEP ou número)
      responses:
        '200':
          description: Endereços encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  addresses:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnderecoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/addresses/{id}:
    put:
      summary: Atualiza endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      description: Atualiza rua, CEP e número do endereço informado. Disponível para Admin e Gestor.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do endereço
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnderecoInput'
      responses:
        '200':
          description: Endereço atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnderecoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Endereço não encontrado
  /api/customers:
    get:
      summary: Lista clientes cadastrados
      tags: [Clientes]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Clientes retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  customers:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ClienteInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      description: Cria um cliente com CPF ou CNPJ, data de nascimento e endereço obrigatório.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClienteInput'
      responses:
        '201':
          description: Cliente criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClienteResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '409':
          description: CPF ou CNPJ duplicado
  /api/customers/search:
    get:
      summary: Busca clientes
      tags: [Clientes]
      security:
        - bearerAuth: []
      description: Pesquisa clientes por nome, email, CPF ou CNPJ. Disponível para Admin, Gestor e Operador.
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo de busca (nome, email, CPF ou CNPJ)
      responses:
        '200':
          description: Clientes encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  customers:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ClienteInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/customers/{id}:
    put:
      summary: Atualiza cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      description: Atualiza dados do cliente (CPF/CNPJ, endereço e contato). Disponível para Admin e Gestor.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do cliente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClienteInput'
      responses:
        '200':
          description: Cliente atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClienteResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Cliente não encontrado
        '409':
          description: CPF ou CNPJ duplicado
  /api/raw-materials:
    get:
      summary: Lista matérias-primas
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Materiais retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  materials:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/MateriaPrimaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra matéria-prima
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Registra uma matéria-prima com informações de custo, validade e características.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MateriaPrimaInput'
      responses:
        '201':
          description: Matéria-prima criada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MateriaPrimaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/raw-materials/search:
    get:
      summary: Busca matérias-primas
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Pesquisa por nome, tipo, material, acessório ou descrição. Disponível para Admin, Gestor e Operador.
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo de busca
      responses:
        '200':
          description: Materiais encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  materials:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/MateriaPrimaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/raw-materials/{id}:
    put:
      summary: Atualiza matéria-prima
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Atualiza informações de uma matéria-prima. Disponível para Admin e Gestor.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da matéria-prima
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MateriaPrimaInput'
      responses:
        '200':
          description: Matéria-prima atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MateriaPrimaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Material não encontrado
  /api/materials:
    get:
      summary: Lista matérias-primas (alias de /api/raw-materials)
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Materiais retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  materials:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/MateriaPrimaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra matéria-prima (alias de /api/raw-materials)
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      description: Registra uma matéria-prima com informações de custo, validade e características.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MateriaPrimaInput'
      responses:
        '201':
          description: Matéria-prima criada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MateriaPrimaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/materials/search:
    get:
      summary: Busca matérias-primas (alias de /api/raw-materials/search)
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo de busca
      responses:
        '200':
          description: Materiais encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  materials:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/MateriaPrimaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/materials/{id}:
    put:
      summary: Atualiza matéria-prima (alias de /api/raw-materials/{id})
      tags: [Matérias-primas]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da matéria-prima
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MateriaPrimaInput'
      responses:
        '200':
          description: Matéria-prima atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MateriaPrimaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Material não encontrado
  /api/manufacturing:
    get:
      summary: Lista relações de manufatura
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Relações retornadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  manufacturing:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ManufaturaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Registra composição de manufatura
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Define a relação entre produto e matéria-prima utilizada, com a quantidade consumida.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ManufaturaInput'
      responses:
        '201':
          description: Relação de manufatura criada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ManufaturaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/manufacturing/search:
    get:
      summary: Busca relações de manufatura
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Pesquisa por produto ou matéria-prima envolvidos. Disponível para Admin, Gestor e Operador.
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID do produto, material ou texto para busca
      responses:
        '200':
          description: Relações encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  manufacturing:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ManufaturaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/manufacturing/{id}:
    put:
      summary: Atualiza relação de manufatura
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Atualiza vínculo entre produto e matéria-prima. Disponível para Admin e Gestor.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da relação de manufatura
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ManufaturaInput'
      responses:
        '200':
          description: Relação de manufatura atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ManufaturaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Relação não encontrada
  /api/manufaturas:
    get:
      summary: Lista relações de manufatura (alias)
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Alias português para /api/manufacturing, disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Relações retornadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  manufacturing:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ManufaturaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Registra composição de manufatura (alias)
      tags: [Manufatura]
      security:
        - bearerAuth: []
      description: Disponível em português como alias de /api/manufacturing.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ManufaturaInput'
      responses:
        '201':
          description: Relação de manufatura criada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ManufaturaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/manufaturas/search:
    get:
      summary: Busca relações de manufatura (alias de /api/manufacturing/search)
      tags: [Manufatura]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID ou termo de busca
      responses:
        '200':
          description: Relações encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  manufacturing:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ManufaturaInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/manufaturas/{id}:
    put:
      summary: Atualiza relação de manufatura (alias de /api/manufacturing/{id})
      tags: [Manufatura]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da relação de manufatura
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ManufaturaInput'
      responses:
        '200':
          description: Relação de manufatura atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ManufaturaResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Relação não encontrada
  /api/material-deliveries:
    get:
      summary: Lista entradas de matéria-prima
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Entradas retornadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  deliveries:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EntregaMaterialInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra entrada de matéria-prima
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      description: Registra a entrega de material por um fornecedor, incluindo data, quantidade e custo.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EntregaMaterialInput'
      responses:
        '201':
          description: Entrada de material registrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EntregaMaterialResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/entregas-material:
    get:
      summary: Lista entradas de matéria-prima (alias)
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      description: Alias em português para /api/material-deliveries.
      responses:
        '200':
          description: Entradas retornadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  deliveries:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EntregaMaterialInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra entrada de matéria-prima (alias)
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      description: Endpoint em português equivalente a /api/material-deliveries.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EntregaMaterialInput'
      responses:
        '201':
          description: Entrada de material registrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EntregaMaterialResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/orders:
    get:
      summary: Lista pedidos
      tags: [Pedidos]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Pedidos retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  orders:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/PedidoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra pedido
      tags: [Pedidos]
      security:
        - bearerAuth: []
      description: Cria um pedido para um cliente, com dados do presenteado quando aplicável.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PedidoInput'
      responses:
        '201':
          description: Pedido criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PedidoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/pedidos:
    get:
      summary: Lista pedidos (alias)
      tags: [Pedidos]
      security:
        - bearerAuth: []
      description: Alias em português para /api/orders.
      responses:
        '200':
          description: Pedidos retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  orders:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/PedidoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra pedido (alias)
      tags: [Pedidos]
      security:
        - bearerAuth: []
      description: Endpoint em português equivalente a /api/orders.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PedidoInput'
      responses:
        '201':
          description: Pedido criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PedidoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/product-shipments:
    get:
      summary: Lista envios de produtos
      tags: [Envios]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Envios retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  shipments:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnvioProdutoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Registra envio de produto
      tags: [Envios]
      security:
        - bearerAuth: []
      description: Liga um pedido a um produto enviado, com data e preço aplicados.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvioProdutoInput'
      responses:
        '201':
          description: Envio registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvioProdutoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/envios:
    get:
      summary: Lista envios de produtos (alias)
      tags: [Envios]
      security:
        - bearerAuth: []
      description: Alias em português para /api/product-shipments.
      responses:
        '200':
          description: Envios retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  shipments:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnvioProdutoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Registra envio de produto (alias)
      tags: [Envios]
      security:
        - bearerAuth: []
      description: Endpoint em português equivalente a /api/product-shipments.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvioProdutoInput'
      responses:
        '201':
          description: Envio registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvioProdutoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/feedbacks:
    get:
      summary: Lista feedbacks
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Feedbacks retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  feedbacks:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/FeedbackInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra feedback
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      description: Registra a avaliação de um cliente sobre um pedido ou serviço prestado.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackInput'
      responses:
        '201':
          description: Feedback registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/feedback:
    get:
      summary: Lista feedbacks (alias)
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      description: Alias singular para /api/feedbacks.
      responses:
        '200':
          description: Feedbacks retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  feedbacks:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/FeedbackInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra feedback (alias)
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      description: Endpoint singular equivalente a /api/feedbacks.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackInput'
      responses:
        '201':
          description: Feedback registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/phones:
    get:
      summary: Lista telefones de clientes
      tags: [Telefones]
      security:
        - bearerAuth: []
      description: Disponível para Admin, Gestor e Operador.
      responses:
        '200':
          description: Telefones retornados
          content:
            application/json:
              schema:
                type: object
                properties:
                  phones:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/TelefoneInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
    post:
      summary: Cadastra telefone de cliente
      tags: [Telefones]
      security:
        - bearerAuth: []
      description: Associa um telefone adicional a um cliente existente.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelefoneInput'
      responses:
        '201':
          description: Telefone cadastrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelefoneResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/material-deliveries/search:
    get:
      summary: Busca entradas de matéria-prima
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de material, fornecedor ou termo relacionado
      responses:
        '200':
          description: Entradas encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  deliveries:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EntregaMaterialInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/material-deliveries/{id}:
    put:
      summary: Atualiza entrada de matéria-prima
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da entrada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EntregaMaterialInput'
      responses:
        '200':
          description: Entrada atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EntregaMaterialResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Entrada não encontrada
  /api/entregas-material/search:
    get:
      summary: Busca entradas de matéria-prima (alias)
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de material, fornecedor ou termo relacionado
      responses:
        '200':
          description: Entradas encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  deliveries:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EntregaMaterialInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/entregas-material/{id}:
    put:
      summary: Atualiza entrada de matéria-prima (alias)
      tags: [Entregas de Material]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID da entrada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EntregaMaterialInput'
      responses:
        '200':
          description: Entrada atualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EntregaMaterialResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Entrada não encontrada
  /api/orders/search:
    get:
      summary: Busca pedidos
      tags: [Pedidos]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de cliente ou termos de pedido
      responses:
        '200':
          description: Pedidos encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  orders:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/PedidoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/orders/{id}:
    put:
      summary: Atualiza pedido
      tags: [Pedidos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do pedido
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PedidoInput'
      responses:
        '200':
          description: Pedido atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PedidoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Pedido não encontrado
  /api/pedidos/search:
    get:
      summary: Busca pedidos (alias)
      tags: [Pedidos]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de cliente ou termos de pedido
      responses:
        '200':
          description: Pedidos encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  orders:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/PedidoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/pedidos/{id}:
    put:
      summary: Atualiza pedido (alias)
      tags: [Pedidos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do pedido
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PedidoInput'
      responses:
        '200':
          description: Pedido atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PedidoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Pedido não encontrado
  /api/product-shipments/search:
    get:
      summary: Busca envios de produto
      tags: [Envios]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de pedido/produto ou termo de envio
      responses:
        '200':
          description: Envios encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  shipments:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnvioProdutoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/product-shipments/{id}:
    put:
      summary: Atualiza envio de produto
      tags: [Envios]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do envio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvioProdutoInput'
      responses:
        '200':
          description: Envio atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvioProdutoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Envio não encontrado
  /api/envios/search:
    get:
      summary: Busca envios de produto (alias)
      tags: [Envios]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: ID de pedido/produto ou termo de envio
      responses:
        '200':
          description: Envios encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  shipments:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/EnvioProdutoInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/envios/{id}:
    put:
      summary: Atualiza envio de produto (alias)
      tags: [Envios]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do envio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvioProdutoInput'
      responses:
        '200':
          description: Envio atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvioProdutoResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Envio não encontrado
  /api/feedbacks/search:
    get:
      summary: Busca feedbacks
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo, contato ou ID de cliente
      responses:
        '200':
          description: Feedbacks encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  feedbacks:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/FeedbackInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/feedbacks/{id}:
    put:
      summary: Atualiza feedback
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do feedback
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackInput'
      responses:
        '200':
          description: Feedback atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Feedback não encontrado
  /api/feedback/search:
    get:
      summary: Busca feedbacks (alias)
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: Termo, contato ou ID de cliente
      responses:
        '200':
          description: Feedbacks encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  feedbacks:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/FeedbackInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/feedback/{id}:
    put:
      summary: Atualiza feedback (alias)
      tags: [Feedbacks]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do feedback
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackInput'
      responses:
        '200':
          description: Feedback atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Feedback não encontrado
  /api/phones/search:
    get:
      summary: Busca telefones
      tags: [Telefones]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: DDD, número ou ID do cliente
      responses:
        '200':
          description: Telefones encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  phones:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/TelefoneInput'
                        - type: object
                          properties:
                            id:
                              type: integer
        '400':
          description: Parâmetro de busca vazio
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
  /api/phones/{id}:
    put:
      summary: Atualiza telefone
      tags: [Telefones]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID do telefone
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelefoneInput'
      responses:
        '200':
          description: Telefone atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelefoneResponse'
        '400':
          description: Falha de validação
        '401':
          description: Token ausente ou inválido
        '403':
          description: Permissão insuficiente
        '404':
          description: Telefone não encontrado
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ItemInput:
      type: object
      required: [codigo, nome, quantidade, preco]
      properties:
        codigo:
          type: string
        nome:
          type: string
        descricao:
          type: string
        categoria:
          type: string
        quantidade:
          type: integer
          nullable: true
          minimum: 0
          default: 0
        preco:
          type: number
          format: float
          minimum: 0
          nullable: true
          default: 0
        fornecedorId:
          type: integer
          nullable: true
        imagemUrl:
          type: string
          format: uri
          description: URL pública (ou relativa) da imagem vinculada ao produto
    ItemResponse:
      type: object
      properties:
        message:
          type: string
        item:
          allOf:
            - $ref: '#/components/schemas/ItemInput'
            - type: object
              properties:
                id:
                  type: integer
    Item:
      allOf:
        - $ref: '#/components/schemas/ItemInput'
        - type: object
          properties:
            id:
              type: integer
            imagemUrl:
              type: string
              format: uri
    ItemImage:
      type: object
      properties:
        id:
          type: integer
        produtoId:
          type: integer
        imagemUrl:
          type: string
          format: uri
    EnderecoInput:
      type: object
      required: [rua, cep, numero]
      properties:
        rua:
          type: string
        cep:
          type: string
        numero:
          type: string
    EnderecoResponse:
      type: object
      properties:
        message:
          type: string
        address:
          allOf:
            - $ref: '#/components/schemas/EnderecoInput'
            - type: object
              properties:
                id:
                  type: integer
    ClienteInput:
      type: object
      required: [nome, dataNascimento, enderecoId]
      properties:
        cnpj:
          type: string
        cpf:
          type: string
        nome:
          type: string
        email:
          type: string
          format: email
        dataNascimento:
          type: string
          format: date
        enderecoId:
          type: integer
          nullable: false
    ClienteResponse:
      type: object
      properties:
        message:
          type: string
        customer:
          allOf:
            - $ref: '#/components/schemas/ClienteInput'
            - type: object
              properties:
                id:
                  type: integer
    MateriaPrimaInput:
      type: object
      required: [nome]
      properties:
        nome:
          type: string
        tipo:
          type: string
        custo:
          type: number
          format: float
          nullable: true
          default: 0
        dataValidade:
          type: string
          format: date
        descricao:
          type: string
        tamanho:
          type: string
        material:
          type: string
        acessorio:
          type: string
    MateriaPrimaResponse:
      type: object
      properties:
        message:
          type: string
        material:
          allOf:
            - $ref: '#/components/schemas/MateriaPrimaInput'
            - type: object
              properties:
                id:
                  type: integer
    ManufaturaInput:
      type: object
      required: [produtoId, materialId, quantidadeMaterial]
      properties:
        produtoId:
          type: integer
        materialId:
          type: integer
        quantidadeMaterial:
          type: integer
          default: 0
          minimum: 0
    ManufaturaResponse:
      type: object
      properties:
        message:
          type: string
        manufacturing:
          allOf:
            - $ref: '#/components/schemas/ManufaturaInput'
            - type: object
              properties:
                id:
                  type: integer
    EntregaMaterialInput:
      type: object
      required: [materialId, quantidade, dataEntrada]
      properties:
        materialId:
          type: integer
        fornecedorId:
          type: integer
          nullable: true
          default: null
        quantidade:
          type: integer
          default: 0
          minimum: 0
        dataEntrada:
          type: string
          format: date
        custo:
          type: number
          format: float
          nullable: true
          default: 0
    EntregaMaterialResponse:
      type: object
      properties:
        message:
          type: string
        delivery:
          allOf:
            - $ref: '#/components/schemas/EntregaMaterialInput'
            - type: object
              properties:
                id:
                  type: integer
    PedidoInput:
      type: object
      required: [clienteId, preco, dataPedido]
      properties:
        clienteId:
          type: integer
          nullable: true
        endereco:
          type: string
        preco:
          type: number
          format: float
          default: 0
          minimum: 0
        dataPedido:
          type: string
          format: date
        cpfPresentado:
          type: string
        nomePresentado:
          type: string
        emailPresentado:
          type: string
          format: email
        enderecoPresentado:
          type: string
    PedidoResponse:
      type: object
      properties:
        message:
          type: string
        order:
          allOf:
            - $ref: '#/components/schemas/PedidoInput'
            - type: object
              properties:
                id:
                  type: integer
    EnvioProdutoInput:
      type: object
      required: [pedidoId, produtoId, quantidade]
      properties:
        pedidoId:
          type: integer
          nullable: true
        produtoId:
          type: integer
          nullable: true
        quantidade:
          type: integer
          default: 0
          minimum: 0
        dataEnvio:
          type: string
          format: date
        preco:
          type: number
          format: float
          default: 0
          minimum: 0
    EnvioProdutoResponse:
      type: object
      properties:
        message:
          type: string
        shipment:
          allOf:
            - $ref: '#/components/schemas/EnvioProdutoInput'
            - type: object
              properties:
                id:
                  type: integer
    FeedbackInput:
      type: object
      required: [clienteId, nota]
      properties:
        clienteId:
          type: integer
          nullable: true
        data:
          type: string
          format: date
        nota:
          type: integer
          default: 0
        contato:
          type: string
        observacao:
          type: string
    FeedbackResponse:
      type: object
      properties:
        message:
          type: string
        feedback:
          allOf:
            - $ref: '#/components/schemas/FeedbackInput'
            - type: object
              properties:
                id:
                  type: integer
    TelefoneInput:
      type: object
      required: [clienteId, numero]
      properties:
        clienteId:
          type: integer
        ddd:
          type: string
        numero:
          type: string
    TelefoneResponse:
      type: object
      properties:
        message:
          type: string
        phone:
          allOf:
            - $ref: '#/components/schemas/TelefoneInput'
            - type: object
              properties:
                id:
                  type: integer
    FornecedorInput:
      type: object
      required: [cnpj, razaoSocial, contato, email, telefone]
      properties:
        cnpj:
          type: string
        razaoSocial:
          type: string
        contato:
          type: string
        email:
          type: string
          format: email
        telefone:
          type: string
        enderecoId:
          type: integer
          nullable: true
    FornecedorResponse:
      type: object
      properties:
        message:
          type: string
        supplier:
          allOf:
            - $ref: '#/components/schemas/FornecedorInput'
            - type: object
              properties:
                id:
                  type: integer
    Fornecedor:
      allOf:
        - $ref: '#/components/schemas/FornecedorInput'
        - type: object
          properties:
            id:
              type: integer
